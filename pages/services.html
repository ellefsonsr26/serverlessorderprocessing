<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order</title>
  <link rel="stylesheet" href="../styles/order.css">
<script src="../auth.js"></script> <!-- Link to shared JavaScript file -->
</head>
<body>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
        enforceAuthentication(); // Redirects to login if user is not authenticated
    });
</script>
  <div id="auth-section"> <!-- displays login and logout button -->
        <button id="login-button" onclick="redirectToLogin()">Login</button>
        <span id="username-display" style="display: none;"></span>
        <button id="logout-button" onclick="logout()" style="display: none;">Logout</button>
    </div>
  <!-- Navbar -->
  <div class="navbar">
    <a href="../index.html">Home</a>
    <a href="services.html">Order</a>
    <div class="dropdown">
      <a>Products</a>
      <div class="dropdown-content">
        <a href="option1.html">Pepperoni Pizza</a>
        <a href="option2.html">Barbecue Chicken Pizza</a>
        <a href="option3.html">Garlic Breadsticks</a>
      </div>
    </div>
  </div>

  <!-- Content -->
<h1>Our Products</h1>
    <div id="product-list">
        <!-- Products will be displayed here -->
    </div>

    <script>
        // Replace with your actual API Gateway URL
        const apiUrl = 'https://s517yim8jj.execute-api.us-east-1.amazonaws.com/Dev/FetchProducts';

        // Function to fetch and display products
        async function fetchProducts() {
            try {
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const products = await response.json();
                
                const productList = document.getElementById('product-list');
                productList.innerHTML = ''; // Clear any previous content

                products.forEach(product => {
                    // Create a product container
                    const productDiv = document.createElement('div');
                    productDiv.classList.add('product');

                    // Product name
                    const name = document.createElement('h2');
                    name.textContent = product.name;
                    productDiv.appendChild(name);

                    // Product description
                    const description = document.createElement('p');
                    description.textContent = product.description;
                    productDiv.appendChild(description);

                    // Product price
                    const price = document.createElement('p');
                    price.classList.add('price');
                    price.textContent = `Price: $${product.price}`;
                    productDiv.appendChild(price);

                    // Add product container to the list
                    productList.appendChild(productDiv);
                });
            } catch (error) {
                console.error("Failed to fetch products:", error);
                const productList = document.getElementById('product-list');
                productList.innerHTML = `<p>Error loading products. Please try again later.</p>`;
            }
        }

        // Fetch products when the page loads
        window.onload = fetchProducts;
    </script>
</body>
</html>

